# Railsにおけるリクエストからレスポンスまでの流れについて説明してください

## 1.リクエストからレスポンスまでの流れについて(GET編)
> とあるSNSアプリがあります。ユーザーの一覧ページがブラウザに表示されるまでの流れを説明してください。
1. ユーザーが、WebブラウザからWebサーバーのURL(```/users```)に対してGETメソッドでHTTPリクエストする。
1. リクエストされたURLを基に、ルーティング（URLに基づいた経路の振り分け）を行い、```routes.rb```に定義された```users```コントローラーの```index```アクションを呼び出す。
1. ```users```コントローラーの```index```アクションにおいて、```User```モデルを通じて、データベースの```users```テーブルから、SQLで全ユーザーのデータを取得する。
1. ```users```コントローラーの```index```アクション内で、インスタンス変数```@users```にデータベースから取得したデータを格納し、それをビューファイルに渡して、HTMLファイルなどの生成を行う。
1. ```users```コントローラがWebサーバーへのレスポンスを作成して、Webサーバーを通じてクライアントへと返す。
1. WebブラウザがHTMLファイルなどを解釈して、ブラウザに表示する。

## 2.リクエストからレスポンスまでの流れについて(POST編)
> とあるタスク管理アプリがあります。タスクを新規作成するときの流れを説明してください。
### 2.1 新規作成ページを表示する
1. 一覧画面(```/tasks```)で新規登録ボタンを押すと、WebブラウザからWebサーバーのURL（```/tasks/new```）に対してGETメソッドでHTTPリクエストする。
1. リクエストされたURLに基づき、ルーティング（URLに基づいた経路の振り分け）を行い、```routes.rb```に定義された```tasks```コントローラーの```new```アクションを呼び出す。
1. ```Task```モデルのインスタンス変数```@task```が新規作成され、```tasks```コントローラの```new```アクションに対応した、新規作成ページ（```/tasks/new```）のビューファイルに渡される。
1. ```tasks```コントローラーがHTMLファイルなどを生成して、Webサーバーを通じて、Webブラウザにリクエストが返され、新規作成ページが表示される。
### 2.2 タスク名(name)を入力する
1. Webブラウザに新規作成ページが表示される。このとき、```form_with```というヘルパーメソッドを利用して、```action`="/tasks"```、```method="post"```を```<form>```タグが生成される.
1. また、```<form>```内の```<input>```要素では、```name=tasks[name]```とパラメータ指定がされており、```task```インスタンスの```name```プロパティと関連付けされている。この```<input>```内にタスク名(name)を入力する。
[![Image from Gyazo](https://i.gyazo.com/61b29a212a35d57d17476f2b74cd11b6.png)](https://gyazo.com/61b29a212a35d57d17476f2b74cd11b6)
### 2.3 作成ボタンを押す
1. 「登録する」ボタンを押すと、今度はWebサーバーのURL（```/tasks```）に対してPOSTメソッドでHTTPリクエストする。このとき、```form_with```メソッド内で記載したフォームの内容（```name=tasks[name]```など）もパラメータとして併せて送信される。
1. 登録する押下後のネットワークタブ。リクエストURL（```/tasks```）とリクエストメソッド(```POST```メソッド)を確認することができる。
[![Image from Gyazo](https://i.gyazo.com/6db9cdab893a4d96298ab38a1c276cae.png)](https://gyazo.com/6db9cdab893a4d96298ab38a1c276cae)
1. リクエストされたURLを基づき、ルーティング（URLに基づいた経路を振り分け）を行い、```routes.rb```に定義された```tasks```コントローラーの```create```アクションを呼び出す。
1. ```tasks```コントローラーの```create```アクション内で、```Task```モデルのインスタンスで、```form_with```メソッドで送信されたパラメータを```params```で取得し、```Task```モデルを通じて、データベースの```tasks```テーブルにデータを保存する。
### 2.4 タスクの詳細画面に遷移する
1. タスクの詳細画面にリダイレクトする。
